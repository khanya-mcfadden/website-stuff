<!Doctype Html>
<Html Lang="En">
  <Head>
    <Link
      Rel="Icon"
      Type="Image/X-Icon"
      Href="{{ Url_For('Static', Filename='Favicon.Ico') }}"
    />
    <Meta Charset="Utf-8" />
    <Meta
      Name="Viewport"
      Content="Width=Device-Width, Initial-Scale=1.0, Maximum-Scale=1.0, User-Scalable=No"
    />
    <Title>{% Block Title %}Home Page{% Endblock %}</Title>
    <Link Rel="Stylesheet" Href="/Static/Main.Css" />
  </Head>
  {% With Group_Name="Test", Sub_Title ="Website Framework Development " %}

  <Body>
    <Div Class="Welcome">
      <Div
        Style="
          Display: Flex;
          Align-Items: Center;
          Justify-Content: Left;
          Flex-Wrap: Wrap;
          Padding: 10px;
        "
      >
        <Img
          Id="Logo"
          Src="{{ Url_For('Static', Filename='Logo.Png') }}"
          Alt="Health Group Website Logo"
          Style="Margin: 5px; Width: 100px; Max-Width: 100%; Height: Auto"
        />
        <Div Style="Display: Flex; Flex-Direction: Column">
          <H1 Style="Text-Align: Left; Margin: 10px; Font-Size: 50px">
            Welcome To The {{ Group_Name }} Website
          </H1>

          <H2
            Style="
              Color: #555;
              Margin: 10px;
              Font-Size: Medium;
              Text-Align: Left;
            "
          >
            Your Trusted Partner In {{ Sub_Title }}
          </H2>
          {% Endwith %}
        </Div>
      </Div>
    </Div>
    <Nav Class="Navbar"></Nav>
    <Nav Class="Nav">
      <!-- Base Page Links -->
      <A Href="/" Style="Color: #111; Font-Size: 1.5em">Home</A>
      <A Href="/About_Page" Style="Color: #111; Font-Size: 1.5em">About</A>
      <A Href="/Weather_Page" Style="Color: #111; Font-Size: 1.5em">Weather</A>
      <A Href="/Bookingpage" Style="Color: #111; Font-Size: 1.5em">Booking</A>
      <A Href="/Articles_Page" Style="Color: #111; Font-Size: 1.5em"
        >Articles</A
      >
      <!-- Admin Page Links -->
      {% If Admin %}
      <A
        Href="/Usersinfo"
        Style="Color: #111; Font-Size: 1.5em; Margin-Left: Auto"
        >User Info</A
      >
      <A Href="/Test" Style="Color: #111; Font-Size: 1.5em">Test</A>
      <!-- Loged In Page Lnks -->
      {% If Authenticated %}
      <A Href="/Profile" Style="Color: #111; Font-Size: 1.5em">Profile</A>
      <!-- Pages That Are Only There When Signed Out -->
      {% Endif %} {% Else %}
      <A
        Href="/Sign-Up"
        Style="Color: #111; Font-Size: 1.5em; Margin-Left: Auto"
        >Sign Up</A
      >
      <A Href="/Login" Style="Color: #111; Font-Size: 1.5em">Login</A>
      {% Endif %}
    </Nav>
    <Div Class="Gradient-Navbar"></Div>

    {% Block Content %}
    <P Style="Font-Size: 2.5rem; Text-Align: Center; Color: #003348">
      We Are Glad To Have You Here. Explore And Enjoy Your Stay!
    </P>

    <Div
      Style="
        Background-Image: Url('/Static/Istockphoto-1299926607-2048x2048.Jpg');
        Background-Size: Cover;
        Width: 100%;
        Height: Auto;
        Text-Align: Center;
        Padding: 20px;
        Overflow: Hidden;
      "
    >
      <!-- Titles -->
      <Div Style="Display: Flex; Justify-Content: Space-Between; Width: 100%">
        <Div
          Id="Season_Title"
          Class="Season_Title"
          Style="Height: Auto; Width: 50%"
        >
          <H1>How To Deal With The Season:</H1>
        </Div>

        <Div Id="Ai_Title" Class="Ai_Title" Style="Height: Auto; Width: 50%">
          <H1>How To Deal With The Season Ai Edition:</H1>
        </Div>
      </Div>

      <!-- Seasonal Advice Containers -->
      <Div Style="Display: Flex; Justify-Content: Space-Between; Width: 100%">
        <!-- Non Ai -->
        <Div
          Class="Container"
          Style="Height: Auto; Width: 50%; Background-Color: #Fff"
        >
          <H2><Span Id="Season"></Span></H2>
          <Div Class="Advice-Box" Id="Advice-Box"></Div>
        </Div>
        <!-- Ai -->
        <Div
          Class="Container"
          Style="Height: Auto; Width: 50%; Background-Color: #Fff"
        >
          <H2>Questions Chat Bot</H2>
          <Div Id="Loading" Style="Display: None; Text-Align: Center">
            <P>Loading...</P>
          </Div>
          <Div
            Id="Ai-Response"
            Class="Ai-Response"
            Style="Font-Size: Larger"
          ></Div>
          <Input
            Type="Text"
            Id="Ai-Question"
            Placeholder="Ask A Question..."
            Style="Bottom: 0"
          />

          <Button Type="Submit" Style="Padding: 10px">Ask</Button>
        </Div>
      </Div>

      <Div Class="Clearfix"></Div>
    </Div>
    <!-- Cookies -->
    {% If Not Request.Cookies.Get('Cookie_Consent') %}
    <Div
      Id="Cookie-Consent"
      Class="Cookie-Consent"
      Style="
        Text-Align: Center;
        Position: Fixed;
        Top: 0;
        Left: -50%;
        Width: 200%;
        Height: 100%;
        Display: Flex;
        Backdrop-Filter: Blur(10px);
        Align-Items: Center;
        Justify-Content: Center;
        Z-Index: 1000;
      "
    >
      <Div Style="Border-Radius: 20px">
        <P>
          We Use Cookies To Improve Your Experience.
          <Br />
          By Using Our Site, You Agree To Our Use Of Cookies.
        </P>
        <Form Method="Post" Action="/Set_Cookie">
          <Button Type="Submit" Class="Btn">Accept</Button>
        </Form>
      </Div>
    </Div>
    <Br />
    {% Endif %} {% Endblock %}
    <!-- Footer -->
    <Div Class="Footer" Id="Footer">
      <Footer>
        <Div Class="Footer-Container">
          <Div Class="Footer-Column">
            <H4>Product</H4>
            <Ul>
              <Li><A Href="/Weather_Page">Weather</A></Li>
              <Li><A Href="/Articles">Articles</A></Li>
              <Li><A Href="/Bookingpage">Assesments</A></Li>
              <Li><A Href="/About_Page">Newcomers</A></Li>
            </Ul>
          </Div>
          <Div Class="Footer-Column">
            <H4>Learning</H4>
            <Ul>
              <Li><A Href="/Unfinishedpagepage">Learn Hub</A></Li>
              <Li><A Href="/Unfinishedpagepage">Tutorials</A></Li>
              <Li><A Href="/Unfinishedpagepage">Communities</A></Li>
            </Ul>
          </Div>

          <Div Class="Footer-Column">
            <H4>About</H4>
            <Ul>
              <Li><A Href="#">Company</A></Li>
              <Li><A Href="#">Legal</A></Li>
              <Li><A Href="#">Help</A></Li>
            </Ul>
          </Div>
        </Div>

        <Div Class="Footer-Logo">
          <Img Src="Https://Via.Placeholder.Com/100x50" Alt="Lift Logo" />
        </Div>

        <Div Class="Footer-Bottom">© 2020 Lift Media. All Rights Reserved.</Div>

        <Div Class="Social-Icons">
          <A Href="Https://En-Gb.Facebook.Com/Login.Php/">Facebook</A>
          <A Href="Https://X.Com/Login?Mx=2">Twitter</A>
          <A Href="Https://Www.Instagram.Com/Accounts/Login/">Instagram</A>
        </Div>
      </Footer>
    </Div>
  </Body>
</Html>

<!-- Scripts -->

<!-- Script For Ai Api -->
<Script>
  Const Submitbutton = Document.Queryselector('Button[Type="Submit"]');
  Submitbutton.Addeventlistener("Click", Function (Event) {
    Event.Preventdefault();
    Const Question = Document.Getelementbyid("Ai-Question").Value.Trim();
    If (!Question) {
      Document.Getelementbyid("Ai-Response").Innerhtml =
        "<P>You Must Type Something In To Get A Response</P>";
      Return;
    }
    If (Question.Tolowercase().Includes("Code")) {
      Document.Getelementbyid("Ai-Response").Innerhtml =
        "<P>Sorry, I Can't Assist With Code-Related Questions.</P>";
      Return;
    }
    Document.Getelementbyid("Loading").Style.Display = "Block"; // Show Loading Indicator
    Fetch("/Ai_Data", {
      Method: "Post",
      Headers: {
        "Content-Type": "Application/Json",
      },
      Body: Json.Stringify({ Question: Question }),
    })
      .Then((Response) => {
        If (!Response.Ok) {
          Throw New Error("Network Response Was Not Ok");
        }
        Return Response.Json();
      })
      .Then((Data) => {
        Console.Log("Ai Data Received:", Data); // Log The Data Received
        Document.Getelementbyid("Loading").Style.Display = "None"; // Hide Loading Indicator
        Const Response1 = Data.Response1
          ? Data.Response1.Replace(/\*/G, "")
          : "No Response1 Available";
        Document.Getelementbyid("Ai-Response").Innerhtml = `
        <P>${Response1}</P>
      `;
      })
      .Catch((Error) => {
        Console.Error("Error Fetching Ai Data:", Error);
        Document.Getelementbyid("Loading").Style.Display = "None"; // Hide Loading Indicator
        Document.Getelementbyid("Ai-Response").Innerhtml =
          "<P>Failed To Load Ai Response</P>";
      });
  });

  // Function To Fetch General Health Recommendation Based On Location On Page Load From
  Window.Onload = Function () {
    Fetch("/Weather_Data")
      .Then((Response) => Response.Json())
      .Then((Data) => {
        If (Data.Error) {
          Console.Error("Error Fetching Weather Data:", Data.Details);
          Document.Getelementbyid("Forecast").Innerhtml =
            "<P>Failed To Load Weather Data</P>";
          Return;
        }
        Const Location = Data.Location.Name;
        Fetch("/Ai_Data", {
          Method: "Post",
          Headers: {
            "Content-Type": "Application/Json",
          },
          Body: Json.Stringify({
            Question: `What Is The Current General Weather Advice Or Recommendations For ${Location}? Keep It Under 150 Words. Recommend That The User Goes To The Weather Page On The Current Website For More Details. As Well As The Met Office`,
          }),
        })
          .Then((Response) => {
            If (!Response.Ok) {
              Throw New Error("Network Response Was Not Ok");
            }
            Return Response.Json();
          })
          .Then((Data) => {
            Console.Log("Ai Data Received On Load:", Data); // Log The Data Received
            Const Response1 = Data.Response1
              ? Data.Response1.Replace(/\*/G, "")
              : "No Response1 Available";
            Document.Getelementbyid("Ai-Response").Innerhtml = `
              <P>${Response1}</P>
            `;
          })
          .Catch((Error) => {
            Console.Error("Error Fetching Ai Data On Load:", Error);
          });
      })
      .Catch((Error) => {
        Console.Error("Error Fetching Weather Data:", Error);
        Document.Getelementbyid("Forecast").Innerhtml =
          "<P>Failed To Load Weather Data</P>";
      });
  };
</Script>

<!-- Script For Logging Location -->
<Script>
  Document.Getelementbyid("Find-Me").Addeventlistener("Click", () => {
    Const Status = Document.Getelementbyid("Status");
    Const Cityname = Document.Getelementbyid("City-Name");
    Const Maplink = Document.Getelementbyid("Map-Link");
    Const Latlon = Document.Getelementbyid("Lat-Lon");

    // Check If Geolocation Is Available
    If (!Navigator.Geolocation) {
      Status.Textcontent = "Geolocation Is Not Supported By Your Browser.";
      Return;
    }

    Status.Textcontent = "Locating…";

    Navigator.Geolocation.Getcurrentposition(
      Async (Position) => {
        Const { Latitude, Longitude } = Position.Coords;

        // Update The Map Link
        Maplink.Href = `Https://Www.Openstreetmap.Org/#Map=18/${Latitude}/${Longitude}`;
        Maplink.Textcontent = `View On Map`;

        // Reverse Geocoding To Get The City Name
        Try {
          Const Response = Await Fetch(
            `Https://Api.Bigdatacloud.Net/Data/Reverse-Geocode-Client?Latitude=${Latitude}&Longitude=${Longitude}&Localitylanguage=En`
          );
          Const Data = Await Response.Json();

          If (Data && Data.City) {
            Cityname.Textcontent = `City: ${Data.City}`;
            Latlon.Textcontent = `Lat: ${Latitude}, Lon: ${Longitude}`;
          } Else {
            Cityname.Textcontent = `Lat: ${Latitude}, Lon: ${Longitude}`;
            Latlon.Textcontent = "";
          }
          Status.Textcontent = "";
        } Catch (Error) {
          Status.Textcontent = "Failed To Fetch City Name.";
        }
      },
      () => {
        Status.Textcontent = "Unable To Retrieve Your Location.";
      }
    );
  });
</Script>

<!--  Script For Seaonal Advice  -->
<Script>
  Fetch("/Weather_Data")
    .Then((Response) => Response.Json())
    .Then((Data) => {
      If (Data.Error) {
        Console.Error("Error Fetching Weather Data:", Data.Details);
        Document.Getelementbyid("Forecast").Innerhtml =
          "<P>Failed To Load Weather Data</P>";
        Return;
      }
      Const Forecastcontainer = Document.Getelementbyid("Forecast");
      Forecastcontainer.Innerhtml = Data.Forecast.Forecastday
        .Map((Day, Index) => {
          Const Date = New Date(Day.Date);
          Const Options = {
            Weekday: "Long",
            Year: "Numeric",
            Month: "Long",
            Day: "Numeric",
          };
          Const Formatteddate =
            Index === 0 ? "Today" : Date.Tolocaledatestring("En-Us", Options);
          Return `
                  <Div Class="Weather-Card">
                      <H2>${Data.Location.Name} - ${Formatteddate}</H2>
                      <Img Src="${Day.Day.Condition.Icon}" Alt="Weather Icon">
                      <P>${Day.Day.Condition.Text}</P>
                      <P>Max Temp: ${Day.Day.Maxtemp_C}&Deg;C</P>
                      <P>Min Temp: ${Day.Day.Mintemp_C}&Deg;C</P>
                  </Div>
              `;
        })
        .Join("");
    })
    .Catch((Error) => {
      Console.Error("Error Fetching Weather Data:", Error);
      Document.Getelementbyid("Forecast").Innerhtml =
        "<P>Failed To Load Weather Data</P>";
    });
  Const Advice = {
    Winter: [
      "<Span Class='Highlight'>Stay Warm</Span>         :Dress In Layers To Keep Warm And Protect Against The Cold.",
      "<Span Class='Highlight'>Hydrate</Span>           : Drink Plenty Of Water To Stay Hydrated, As Indoor Heating Can Cause Dehydration.",
      "<Span Class='Highlight'>Moisturize</Span>        : Use Moisturizers To Prevent Dry Skin Caused By Cold Weather And Indoor Heating.",
      "<Span Class='Highlight'>Eat Nutritiously</Span>  : Consume A Balanced Diet Rich In Vitamins And Minerals To Boost Your Immune System .Exercise Indoors: Engage In Indoor Physical Activities To Stay Active And Maintain Fitness.",
      "<Span Class='Highlight'>Get Vaccinated</Span>    : Ensure You Are Up-To-Date With Flu Vaccinations To Protect Against Seasonal Flu",
      "<Span Class='Highlight'>Wash Hands</Span>         : Practice Good Hygiene By Washing Hands Frequently To Prevent The Spread Of Germs..",
      "<Span Class='Highlight'>Stay Connected</Span>  : Maintain Social Connections To Combat Winter Blues And Seasonal Affective Disorder (Sad).",
    ],
    Spring: [
      "<Span Class='Highlight'>Allergy Management</Span> : Keep Windows Closed During High Pollen Days And Take Antihistamines If Needed.",
      "<Span Class='Highlight'>Stay Active</Span> : Take Advantage Of The Mild Weather To Engage In Outdoor Activities Like Walking Or Cycling.",
    ],
    Summer: [
      "<Span Class='Highlight'>Stay Hydrated</Span> : Drink Plenty Of Water To Stay Hydrated In The Heat.",
      "<Span Class='Highlight'>Sun Protection</Span> : Wear Sunscreen, Hats, And Sunglasses To Protect Against Harmful Uv Rays.",
    ],
    Autumn: [
      "<Span Class='Highlight'>Layer Up</Span> : Dress In Layers To Adjust To Fluctuating Temperatures.",
      "<Span Class='Highlight'>Boost Immunity</Span> : Eat A Diet Rich In Vitamins To Strengthen Your Immune System For The Cold Season.",
    ],
  };

  Function Getseason() {
    Const Month = New Date().Getmonth();
    If (Month >= 2 && Month <= 4) Return "Spring";
    If (Month >= 5 && Month <= 7) Return "Summer";
    If (Month >= 8 && Month <= 10) Return "Autumn";
    Return "Winter";
  }

  Function Displayadvice() {
    Const Season = Getseason();
    Document.Getelementbyid("Season").Textcontent = Season;
    Const Seasonadvice = Advice[Season] || [
      "No Advice Available For This Season.",
    ];
    Document.Getelementbyid("Advice-Box").Innerhtml = Seasonadvice
      .Map((Item) => `<P>${Item}</P>`)
      .Join("");
  }

  Displayadvice();
</Script>

<!-- Script For Weather  -->
<Script>
  Fetch("/Weather_Data")
    .Then((Response) => Response.Json())
    .Then((Data) => {
      If (Data.Error) {
        Console.Error("Error Fetching Weather Data:", Data.Details);
        Document.Getelementbyid("Forecast").Innerhtml =
          "<P>Failed To Load Weather Data</P>";
        Return;
      }
      Const Forecastcontainer = Document.Getelementbyid("Forecast");
      Forecastcontainer.Innerhtml = Data.Forecast.Forecastday
        .Map((Day, Index) => {
          Const Date = New Date(Day.Date);
          Const Options = {
            Weekday: "Long",
            Year: "Numeric",
            Month: "Long",
            Day: "Numeric",
          };
          Const Formatteddate =
            Index === 0 ? "Today" : Date.Tolocaledatestring("En-Us", Options);
          Return `
        <Div Class="Weather-Card">
            <H2>${Data.Location.Name} - ${Formatteddate}</H2>
            <Img Src="${Day.Day.Condition.Icon}" Alt="Weather Icon">
            <P>${Day.Day.Condition.Text}</P>
            <P>Max Temp: ${Day.Day.Maxtemp_C}&Deg;C</P>
            <P>Min Temp: ${Day.Day.Mintemp_C}&Deg;C</P>
        </Div>
    `;
        })
        .Join("");
    })
    .Catch((Error) => {
      Console.Error("Error Fetching Weather Data:", Error);
      Document.Getelementbyid("Forecast").Innerhtml =
        "<P>Failed To Load Weather Data</P>";
    });
</Script>
